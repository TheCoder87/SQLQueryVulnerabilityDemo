using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Configuration;

namespace SQLQueryVulnerabilityDemo
{
    public class Program
    {
        public static void Main(string[] args)
        {
            string connectionString = ConfigurationManager.ConnectionStrings["DBConnectionString"].ConnectionString;

            SqlQueriesClass queries = new SqlQueriesClass();
            Console.WriteLine("After Running Unsafe Queries \nAccountNumber: "+queries.UnsafeQuery(connectionString, "' OR 1=1 --", "anything"));
            // Resultant query (which is always true): 
            // SELECT AccountNumber FROM Users WHERE Username='' OR 1=1

            Console.WriteLine("After Running Safe Queries \nAccountNumber: " + queries.SaferQuery(connectionString, "' OR 1 = 1 --", "anything"));
            // Resultant query (notice the additional single quote character):
            // SELECT AccountNumber FROM Users WHERE Username=''' OR 1=1 --'
            //                                   AND Password='anything'



            Console.WriteLine();
            Console.Write("Press any ley to exit...");
            Console.ReadKey();
        }
    }
}
